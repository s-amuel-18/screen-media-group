!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global=global||self).ScrollReveal=factory()}(this,function(){"use strict";var defaults={delay:0,distance:"0",duration:600,easing:"cubic-bezier(0.5, 0, 0, 1)",interval:0,opacity:0,origin:"bottom",rotate:{x:0,y:0,z:0},scale:1,cleanup:!1,container:document.documentElement,desktop:!0,mobile:!0,reset:!1,useDelay:"always",viewFactor:0,viewOffset:{top:0,right:0,bottom:0,left:0},afterReset:function(){},afterReveal:function(){},beforeReset:function(){},beforeReveal:function(){}};var mount={success:function(){document.documentElement.classList.add("sr"),document.body?document.body.style.height="100%":document.addEventListener("DOMContentLoaded",function(){document.body.style.height="100%"})},failure:function(){return document.documentElement.classList.remove("sr"),{clean:function(){},destroy:function(){},reveal:function(){},sync:function(){},get noop(){return!0}}}};function isDomNode(x){return"object"==typeof window.Node?x instanceof window.Node:null!==x&&"object"==typeof x&&"number"==typeof x.nodeType&&"string"==typeof x.nodeName}function tealight(target,context){if(void 0===context&&(context=document),target instanceof Array)return target.filter(isDomNode);if(isDomNode(target))return[target];if(x=target,prototypeToString=Object.prototype.toString.call(x),"object"==typeof window.NodeList?x instanceof window.NodeList:null!==x&&"object"==typeof x&&"number"==typeof x.length&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(prototypeToString)&&(0===x.length||isDomNode(x[0])))return Array.prototype.slice.call(target);var x,prototypeToString;if("string"==typeof target)try{var query=context.querySelectorAll(target);return Array.prototype.slice.call(query)}catch(err){return[]}return[]}function isObject(x){return null!==x&&x instanceof Object&&(x.constructor===Object||"[object Object]"===Object.prototype.toString.call(x))}function each(collection,callback){if(isObject(collection))return Object.keys(collection).forEach(function(key){return callback(collection[key],key,collection)});if(collection instanceof Array)return collection.forEach(function(item,i){return callback(item,i,collection)});throw new TypeError("Expected either an array or object literal.")}function logger(message){for(var report,details=[],len=arguments.length-1;0<len--;)details[len]=arguments[len+1];this.constructor.debug&&console&&(report="%cScrollReveal: "+message,details.forEach(function(detail){return report+="\n â€” "+detail}),console.log(report,"color: #ea654b;"))}function rinse(){function struct(){return{active:[],stale:[]}}var this$1=this,elementIds=struct(),sequenceIds=struct(),containerIds=struct();try{each(tealight("[data-sr-id]"),function(id){id=parseInt(id.getAttribute("data-sr-id"));elementIds.active.push(id)})}catch(e){throw e}each(this.store.elements,function(element){-1===elementIds.active.indexOf(element.id)&&elementIds.stale.push(element.id)}),each(elementIds.stale,function(staleId){return delete this$1.store.elements[staleId]}),each(this.store.elements,function(element){-1===containerIds.active.indexOf(element.containerId)&&containerIds.active.push(element.containerId),element.hasOwnProperty("sequence")&&-1===sequenceIds.active.indexOf(element.sequence.id)&&sequenceIds.active.push(element.sequence.id)}),each(this.store.containers,function(container){-1===containerIds.active.indexOf(container.id)&&containerIds.stale.push(container.id)}),each(containerIds.stale,function(staleId){var stale=this$1.store.containers[staleId].node;stale.removeEventListener("scroll",this$1.delegate),stale.removeEventListener("resize",this$1.delegate),delete this$1.store.containers[staleId]}),each(this.store.sequences,function(sequence){-1===sequenceIds.active.indexOf(sequence.id)&&sequenceIds.stale.push(sequence.id)}),each(sequenceIds.stale,function(staleId){return delete this$1.store.sequences[staleId]})}function clean(target){var dirty,this$1=this;try{each(tealight(target),function(node){var element,id=node.getAttribute("data-sr-id");null!==id&&(dirty=!0,(element=this$1.store.elements[id]).callbackTimer&&window.clearTimeout(element.callbackTimer.clock),node.setAttribute("style",element.styles.inline.generated),node.removeAttribute("data-sr-id"),delete this$1.store.elements[id])})}catch(e){return logger.call(this,"Clean failed.",e.message)}if(dirty)try{rinse.call(this)}catch(e){return logger.call(this,"Clean failed.",e.message)}}function format(source){if(source.constructor!==Array)throw new TypeError("Expected array.");if(16===source.length)return source;if(6!==source.length)throw new RangeError("Expected array with either 6 or 16 values.");var matrix=identity();return matrix[0]=source[0],matrix[1]=source[1],matrix[4]=source[2],matrix[5]=source[3],matrix[12]=source[4],matrix[13]=source[5],matrix}function identity(){for(var matrix=[],i=0;i<16;i++)i%5==0?matrix.push(1):matrix.push(0);return matrix}function multiply(m,x){for(var fm=format(m),fx=format(x),product=[],i=0;i<4;i++)for(var row=[fm[i],fm[i+4],fm[i+8],fm[i+12]],j=0;j<4;j++){var k=4*j,col=[fx[k],fx[1+k],fx[2+k],fx[3+k]];product[i+k]=row[0]*col[0]+row[1]*col[1]+row[2]*col[2]+row[3]*col[3]}return product}function scale(scalar,scalarY){var matrix=identity();return matrix[0]=scalar,matrix[5]="number"==typeof scalarY?scalarY:scalar,matrix}var getPrefixedCssProp=function(){var properties={},style=document.documentElement.style;function getPrefixedCssProperty(name,source){if(void 0===source&&(source=style),name&&"string"==typeof name){if(properties[name])return properties[name];if("string"==typeof source[name])return properties[name]=name;if("string"==typeof source["-webkit-"+name])return properties[name]="-webkit-"+name;throw new RangeError('Unable to find "'+name+'" style property.')}throw new TypeError("Expected a string.")}return getPrefixedCssProperty.clearCache=function(){return properties={}},getPrefixedCssProperty}();function style(element){var computed=window.getComputedStyle(element.node),position=computed.position,composed=element.config,inline={},opacity=(element.node.getAttribute("style")||"").match(/[\w-]+\s*:\s*[^;]+\s*/gi)||[];inline.computed=opacity?opacity.map(function(m){return m.trim()}).join("; ")+";":"",inline.generated=opacity.some(function(m){return m.match(/visibility\s?:\s?visible/i)})?inline.computed:opacity.concat(["visibility: visible"]).map(function(m){return m.trim()}).join("; ")+";";var delay=parseFloat(computed.opacity),ref=isNaN(parseFloat(composed.opacity))?parseFloat(computed.opacity):parseFloat(composed.opacity),opacity={computed:delay!==ref?"opacity: "+delay+";":"",generated:delay!==ref?"opacity: "+ref+";":""},delay=[];if(parseFloat(composed.distance)){var axis="top"===composed.origin||"bottom"===composed.origin?"Y":"X",distance=composed.distance,ref=(distance="top"===composed.origin||"left"===composed.origin?/^-/.test(distance)?distance.substr(1):"-"+distance:distance).match(/(^-?\d+\.?\d?)|(em$|px$|%$)/g),value=ref[0];switch(ref[1]){case"em":distance=parseInt(computed.fontSize)*value;break;case"px":distance=value;break;case"%":distance="Y"==axis?element.node.getBoundingClientRect().height*value/100:element.node.getBoundingClientRect().width*value/100;break;default:throw new RangeError("Unrecognized or missing distance unit.")}"Y"==axis?delay.push(function(distance){var matrix=identity();return matrix[13]=distance,matrix}(distance)):delay.push(function(distance){var matrix=identity();return matrix[12]=distance,matrix}(distance))}composed.rotate.x&&delay.push((transition=composed.rotate.x,transform=Math.PI/180*transition,(transition=identity())[5]=transition[10]=Math.cos(transform),transition[6]=transition[9]=Math.sin(transform),transition[9]*=-1,transition)),composed.rotate.y&&delay.push(function(matrix){var theta=Math.PI/180*matrix;return(matrix=identity())[0]=matrix[10]=Math.cos(theta),matrix[2]=matrix[8]=Math.sin(theta),matrix[2]*=-1,matrix}(composed.rotate.y)),composed.rotate.z&&delay.push(function(matrix){var theta=Math.PI/180*matrix;return(matrix=identity())[0]=matrix[5]=Math.cos(theta),matrix[1]=matrix[4]=Math.sin(theta),matrix[4]*=-1,matrix}(composed.rotate.z)),1!==composed.scale&&(0===composed.scale?delay.push(scale(2e-4)):delay.push(scale(composed.scale)));var transform={};delay.length?(transform.property=getPrefixedCssProp("transform"),transform.computed={raw:computed[transform.property],matrix:function(match){if("string"==typeof match){match=match.match(/matrix(3d)?\(([^)]+)\)/);if(match)return format(match[2].split(", ").map(parseFloat))}return identity()}(computed[transform.property])},delay.unshift(transform.computed.matrix),duration=delay.reduce(multiply),transform.generated={initial:transform.property+": matrix3d("+duration.join(", ")+");",final:transform.property+": matrix3d("+transform.computed.matrix.join(", ")+");"}):transform.generated={initial:"",final:""};var duration,transition={};return opacity.generated||transform.generated.initial?(transition.property=getPrefixedCssProp("transition"),transition.computed=computed[transition.property],transition.fragments=[],delay=composed.delay,duration=composed.duration,composed=composed.easing,opacity.generated&&transition.fragments.push({delayed:"opacity "+duration/1e3+"s "+composed+" "+delay/1e3+"s",instant:"opacity "+duration/1e3+"s "+composed+" 0s"}),transform.generated.initial&&transition.fragments.push({delayed:transform.property+" "+duration/1e3+"s "+composed+" "+delay/1e3+"s",instant:transform.property+" "+duration/1e3+"s "+composed+" 0s"}),transition.computed&&!transition.computed.match(/all 0s|none 0s/)&&transition.fragments.unshift({delayed:transition.computed,instant:transition.computed}),composed=transition.fragments.reduce(function(composition,fragment,i){return composition.delayed+=0===i?fragment.delayed:", "+fragment.delayed,composition.instant+=0===i?fragment.instant:", "+fragment.instant,composition},{delayed:"",instant:""}),transition.generated={delayed:transition.property+": "+composed.delayed+";",instant:transition.property+": "+composed.instant+";"}):transition.generated={delayed:"",instant:""},{inline:inline,opacity:opacity,position:position,transform:transform,transition:transition}}function animate(element,force){var shouldReset=(force=void 0===force?{}:force).pristine||this.pristine,delayed="always"===element.config.useDelay||"onload"===element.config.useDelay&&shouldReset||"once"===element.config.useDelay&&!element.seen,shouldReveal=element.visible&&!element.revealed,shouldReset=!element.visible&&element.revealed&&element.config.reset;return force.reveal||shouldReveal?function(element,delayed){var styles=[element.styles.inline.generated,element.styles.opacity.computed,element.styles.transform.generated.final];delayed?styles.push(element.styles.transition.generated.delayed):styles.push(element.styles.transition.generated.instant);element.revealed=element.seen=!0,element.node.setAttribute("style",styles.filter(function(s){return""!==s}).join(" ")),registerCallbacks.call(this,element,delayed)}.call(this,element,delayed):force.reset||shouldReset?function(element){var styles=[element.styles.inline.generated,element.styles.opacity.generated,element.styles.transform.generated.initial,element.styles.transition.generated.instant];element.revealed=!1,element.node.setAttribute("style",styles.filter(function(s){return""!==s}).join(" ")),registerCallbacks.call(this,element)}.call(this,element):void 0}function registerCallbacks(element,elapsed){var this$1=this,duration=elapsed?element.config.duration+element.config.delay:element.config.duration,beforeCallback=element.revealed?element.config.beforeReveal:element.config.beforeReset,afterCallback=element.revealed?element.config.afterReveal:element.config.afterReset,elapsed=0;element.callbackTimer&&(elapsed=Date.now()-element.callbackTimer.start,window.clearTimeout(element.callbackTimer.clock)),beforeCallback(element.node),element.callbackTimer={start:Date.now(),clock:window.setTimeout(function(){afterCallback(element.node),element.callbackTimer=null,element.revealed&&!element.config.reset&&element.config.cleanup&&clean.call(this$1,element.node)},duration-elapsed)}}var uid,nextUniqueId=(uid=0,function(){return uid++});function sequence(element,pristine){if(void 0===pristine&&(pristine=this.pristine),!element.visible&&element.revealed&&element.config.reset)return animate.call(this,element,{reset:!0});var seq=this.store.sequences[element.sequence.id],i=element.sequence.index;if(seq){var visible=new SequenceModel(seq,"visible",this.store),revealed=new SequenceModel(seq,"revealed",this.store);if(seq.models={visible:visible,revealed:revealed},!revealed.body.length){var nextElement=seq.members[visible.body[0]],nextElement=this.store.elements[nextElement];if(nextElement)return cue.call(this,seq,visible.body[0],-1,pristine),cue.call(this,seq,visible.body[0],1,pristine),animate.call(this,nextElement,{reveal:!0,pristine:pristine})}return!seq.blocked.head&&i===[].concat(revealed.head).pop()&&i>=[].concat(visible.body).shift()?(cue.call(this,seq,i,-1,pristine),animate.call(this,element,{reveal:!0,pristine:pristine})):!seq.blocked.foot&&i===[].concat(revealed.foot).shift()&&i<=[].concat(visible.body).pop()?(cue.call(this,seq,i,1,pristine),animate.call(this,element,{reveal:!0,pristine:pristine})):void 0}}function Sequence(i){i=Math.abs(i);if(isNaN(i))throw new RangeError("Invalid sequence interval.");this.id=nextUniqueId(),this.interval=Math.max(i,16),this.members=[],this.models={},this.blocked={head:!1,foot:!1}}function SequenceModel(seq,prop,store){var this$1=this;this.head=[],this.body=[],this.foot=[],each(seq.members,function(element,index){element=store.elements[element];element&&element[prop]&&this$1.body.push(index)}),this.body.length&&each(seq.members,function(element,index){element=store.elements[element];element&&!element[prop]&&(index<this$1.body[0]?this$1.head:this$1.foot).push(index)})}function cue(seq,i,nextId,pristine){var this$1=this,blocked=["head",null,"foot"][1+nextId],nextId=seq.members[i+nextId],nextElement=this.store.elements[nextId];seq.blocked[blocked]=!0,setTimeout(function(){seq.blocked[blocked]=!1,nextElement&&sequence.call(this$1,nextElement,pristine)},seq.interval)}function initialize(){var this$1=this;rinse.call(this),each(this.store.elements,function(element){var styles=[element.styles.inline.generated];element.visible?(styles.push(element.styles.opacity.computed),styles.push(element.styles.transform.generated.final),element.revealed=!0):(styles.push(element.styles.opacity.generated),styles.push(element.styles.transform.generated.initial),element.revealed=!1),element.node.setAttribute("style",styles.filter(function(s){return""!==s}).join(" "))}),each(this.store.containers,function(target){target=target.node===document.documentElement?window:target.node;target.addEventListener("scroll",this$1.delegate),target.addEventListener("resize",this$1.delegate)}),this.delegate(),this.initTimeout=null}function isMobile(agent){return void 0===agent&&(agent=navigator.userAgent),/Android|iPhone|iPad|iPod/i.test(agent)}function deepAssign(target){for(var sources=[],len=arguments.length-1;0<len--;)sources[len]=arguments[len+1];if(isObject(target))return each(sources,function(source){each(source,function(data,key){isObject(data)?(target[key]&&isObject(target[key])||(target[key]={}),deepAssign(target[key],data)):target[key]=data})}),target;throw new TypeError("Target must be an object literal.")}function reveal(target,options,syncing){var this$1=this;void 0===syncing&&(syncing=!1);var sequence$$1,containerBuffer=[],interval=(options=void 0===options?{}:options).interval||defaults.interval;try{interval&&(sequence$$1=new Sequence(interval));var nodes=tealight(target);if(!nodes.length)throw new Error("Invalid reveal target.");var elements=nodes.reduce(function(elementBuffer,containerId){var element={},containerNode=containerId.getAttribute("data-sr-id");containerNode?(deepAssign(element,this$1.store.elements[containerNode]),element.node.setAttribute("style",element.styles.inline.computed)):(element.id=nextUniqueId(),element.node=containerId,element.seen=!1,element.revealed=!1,element.visible=!1);var config=deepAssign({},element.config||this$1.defaults,options);if(!config.mobile&&isMobile()||!config.desktop&&!isMobile())return containerNode&&clean.call(this$1,element),elementBuffer;containerNode=tealight(config.container)[0];if(!containerNode)throw new Error("Invalid container.");return containerNode.contains(containerId)&&(null===(containerId=function(node){var collections=[],len=arguments.length-1;for(;0<len--;)collections[len]=arguments[len+1];var id=null;return each(collections,function(collection){each(collection,function(container){null===id&&container.node===node&&(id=container.id)})}),id}(containerNode,containerBuffer,this$1.store.containers))&&(containerId=nextUniqueId(),containerBuffer.push({id:containerId,node:containerNode})),element.config=config,element.containerId=containerId,element.styles=style(element),sequence$$1&&(element.sequence={id:sequence$$1.id,index:sequence$$1.members.length},sequence$$1.members.push(element.id)),elementBuffer.push(element)),elementBuffer},[]);each(elements,function(element){(this$1.store.elements[element.id]=element).node.setAttribute("data-sr-id",element.id)})}catch(e){return logger.call(this,"Reveal failed.",e.message)}each(containerBuffer,function(container){this$1.store.containers[container.id]={id:container.id,node:container.node}}),sequence$$1&&(this.store.sequences[sequence$$1.id]=sequence$$1),!0!==syncing&&(this.store.history.push({target:target,options:options}),this.initTimeout&&window.clearTimeout(this.initTimeout),this.initTimeout=window.setTimeout(initialize.bind(this),0))}var clock,mathSign=Math.sign||function(x){return(0<x)-(x<0)||+x},polyfill$1=(clock=Date.now(),function(callback){var currentTime=Date.now();16<currentTime-clock?callback(clock=currentTime):setTimeout(function(){return polyfill$1(callback)},0)}),miniraf=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||polyfill$1;function getGeometry(target,width){for(var height=width?target.node.clientHeight:target.node.offsetHeight,width=width?target.node.clientWidth:target.node.offsetWidth,offsetTop=0,offsetLeft=0,node=target.node;isNaN(node.offsetTop)||(offsetTop+=node.offsetTop),isNaN(node.offsetLeft)||(offsetLeft+=node.offsetLeft),node=node.offsetParent;);return{bounds:{top:offsetTop,right:offsetLeft+width,bottom:offsetTop+height,left:offsetLeft},height:height,width:width}}function delegate(event,elements){var this$1=this;void 0===event&&(event={type:"init"}),void 0===elements&&(elements=this.store.elements),miniraf(function(){var stale="init"===event.type||"resize"===event.type;each(this$1.store.containers,function(container){stale&&(container.geometry=getGeometry.call(this$1,container,!0));var scroll=function(left){var top,left=left.node===document.documentElement?(top=window.pageYOffset,window.pageXOffset):(top=left.node.scrollTop,left.node.scrollLeft);return{top:top,left:left}}.call(this$1,container);container.scroll&&(container.direction={x:mathSign(scroll.left-container.scroll.left),y:mathSign(scroll.top-container.scroll.top)}),container.scroll=scroll}),each(elements,function(element){!stale&&void 0!==element.geometry||(element.geometry=getGeometry.call(this$1,element)),element.visible=function(element){var container=this.store.containers[(element=void 0===element?{}:element).containerId];if(container){var containerBounds_bottom=Math.max(0,Math.min(1,element.config.viewFactor)),containerBounds_left=element.config.viewOffset,elementBounds_top=element.geometry.bounds.top+element.geometry.height*containerBounds_bottom,elementBounds_right=element.geometry.bounds.right-element.geometry.width*containerBounds_bottom,elementBounds_bottom=element.geometry.bounds.bottom-element.geometry.height*containerBounds_bottom,elementBounds_left=element.geometry.bounds.left+element.geometry.width*containerBounds_bottom,containerBounds_top=container.geometry.bounds.top+container.scroll.top+containerBounds_left.top,containerBounds_right=container.geometry.bounds.right+container.scroll.left-containerBounds_left.right,containerBounds_bottom=container.geometry.bounds.bottom+container.scroll.top-containerBounds_left.bottom,containerBounds_left=container.geometry.bounds.left+container.scroll.left+containerBounds_left.left;return elementBounds_top<containerBounds_bottom&&containerBounds_left<elementBounds_right&&containerBounds_top<elementBounds_bottom&&elementBounds_left<containerBounds_right||"fixed"===element.styles.position}}.call(this$1,element)}),each(elements,function(element){(element.sequence?sequence:animate).call(this$1,element)}),this$1.pristine=!1})}var boundDelegate,boundDestroy,boundReveal,boundClean,boundSync,config,debug,instance,version="4.0.7";function ScrollReveal(options){var buffer;if(void 0===options&&(options={}),void 0===this||Object.getPrototypeOf(this)!==ScrollReveal.prototype)return new ScrollReveal(options);if(!ScrollReveal.isSupported())return logger.call(this,"Instantiation failed.","This browser is not supported."),mount.failure();try{buffer=deepAssign({},config||defaults,options)}catch(e){return logger.call(this,"Invalid configuration.",e.message),mount.failure()}try{if(!tealight(buffer.container)[0])throw new Error("Invalid container.")}catch(e){return logger.call(this,e.message),mount.failure()}return!(config=buffer).mobile&&isMobile()||!config.desktop&&!isMobile()?(logger.call(this,"This device is disabled.","desktop: "+config.desktop,"mobile: "+config.mobile),mount.failure()):(mount.success(),this.store={containers:{},elements:{},history:[],sequences:{}},this.pristine=!0,boundDelegate=boundDelegate||delegate.bind(this),boundDestroy=boundDestroy||function(){var this$1=this;each(this.store.elements,function(element){element.node.setAttribute("style",element.styles.inline.generated),element.node.removeAttribute("data-sr-id")}),each(this.store.containers,function(target){target=target.node===document.documentElement?window:target.node;target.removeEventListener("scroll",this$1.delegate),target.removeEventListener("resize",this$1.delegate)}),this.store={containers:{},elements:{},history:[],sequences:{}}}.bind(this),boundReveal=boundReveal||reveal.bind(this),boundClean=boundClean||clean.bind(this),boundSync=boundSync||function(){var this$1=this;each(this.store.history,function(record){reveal.call(this$1,record.target,record.options,!0)}),initialize.call(this)}.bind(this),Object.defineProperty(this,"delegate",{get:function(){return boundDelegate}}),Object.defineProperty(this,"destroy",{get:function(){return boundDestroy}}),Object.defineProperty(this,"reveal",{get:function(){return boundReveal}}),Object.defineProperty(this,"clean",{get:function(){return boundClean}}),Object.defineProperty(this,"sync",{get:function(){return boundSync}}),Object.defineProperty(this,"defaults",{get:function(){return config}}),Object.defineProperty(this,"version",{get:function(){return version}}),Object.defineProperty(this,"noop",{get:function(){return!1}}),instance=instance||this)}return ScrollReveal.isSupported=function(){return("transform"in(style=document.documentElement.style)||"WebkitTransform"in style)&&function(){var style=document.documentElement.style;return"transition"in style||"WebkitTransition"in style}();var style},Object.defineProperty(ScrollReveal,"debug",{get:function(){return debug||!1},set:function(value){return debug="boolean"==typeof value?value:debug}}),ScrollReveal(),ScrollReveal});